# 📋 Development Log

---

### 📅 [2026-01-15] : 정산 결과 페이지 고도화 및 사용자 경험 최적화 - 개인화된 정산 옵션 및 재무 투명성 강화

#### 1. 🔄 What Changed (변경 사항 & 작업 내역)

- **개인화된 정산 옵션 시스템 구축**: 멤버별 독립적인 10원 단위 올림(매너 정산) 토글 기능 구현

    - `tippedModeByMember` 상태 관리 시스템 도입: 멤버별 개별 토글 상태 추적 (`{ [memberId]: boolean }`)
    - 동적 데이터 바인딩 로직 구현: `settlement_amount` / `settlement_tipped_amount` 조건부 렌더링
    - 토스/카카오 입금 링크 및 계좌 복사 텍스트 동적 전환: `tipped_toss_deposit_link`, `tipped_kakao_deposit_link`, `tipped_deposit_copy_text` 활용
    - 시각적 피드백 강화: 토글 활성화 시 링 스타일 및 스케일 효과로 사용자 인지도 향상
    - 사용자 선택권 확대: 전역 토글이 아닌 개별 멤버 단위 제어로 유연한 정산 프로세스 제공

- **공금 지갑 재무 투명성 강화**: 실제 총 잔액 및 공금 출처 시각화 개선

    - `real_total_remaining_krw` 필드 통합: 실제 총 잔액(초기 공금 - 총 지출) 명시적 표시
    - 공금 출처 구분 표시: 초기 공금(`initial_gonggeum`)과 추가 공금(`added_gonggeum`) 분리 표기
    - 외화 추가 공금 정보 표시: `added_foreign` 필드 활용으로 외화 추가 금액 및 원화 환산액 동시 표시
    - 소수점 처리 및 안내 메시지: `Math.floor()` 적용으로 소수점 제거 및 사용자 안내 문구 추가
    - 환율 투명성 강화: 소수점 계산으로 인한 인터넷 환율과의 차이점 안내 메시지 추가

- **에러 핸들링 및 사용자 경험 개선**: 404 Not Found 에러 전용 UI 구현

    - 조건부 에러 렌더링: 404 에러 시 전용 에러 페이지 표시
    - 사용자 친화적 에러 메시지: "여행 정산 결과를 찾을 수 없습니다" 명확한 안내
    - 재시도 기능: `handleRefresh` 함수를 통한 데이터 재요청 기능 제공
    - 네비게이션 옵션: 홈으로 이동 버튼으로 사용자 이탈 방지

- **모바일 반응형 UX 최적화**: 가로 스크롤 이슈 해결 및 레이아웃 안정화

    - `AddExpenseModal` 레이아웃 개선: `overflow-x-hidden` 적용 및 `min-w-0`, `flex-shrink-0` 유틸리티 클래스 활용
    - `CreateTripWizard` 멤버 추가 인풋 최적화: 플렉스 컨테이너 내 입력 필드 및 버튼 크기 제어
    - 모바일 환경에서의 모달 가로 스크롤 완전 제거: 사용자 혼란 감소 및 일관된 UX 제공

- **데이터 구조 표준화**: API 응답 형식과 프론트엔드 데이터 바인딩 일치화

    - camelCase → snake_case 전환: `simpleSettlementResultPage`, `ResultPage` 컴포넌트 데이터 키 통일
    - API 스펙 준수: 백엔드 응답 구조와 일치하도록 데이터 접근 로직 수정
    - 타입 안정성 향상: 일관된 네이밍 컨벤션으로 개발자 경험 개선

- **정산 대시보드 네비게이션 강화**: 결과 페이지에서 대시보드 접근성 향상

    - "정산 대시보드 보러 가기" 버튼 추가: `/meeting/share/trip?uuid=${uuid}` 링크 통합
    - 사용자 여정 연속성 확보: 정산 결과 확인 후 상세 내역 조회 가능한 플로우 제공

- **입금 정보 등록 UX 개선**: 토스트 메시지 및 로딩 상태 피드백 강화

    - `BillingTossModal`, `BillingKakaoModal` 로딩 상태 추가: "저장 중..." 텍스트 및 버튼 비활성화
    - 성공 피드백 토스트: "저장이 완료되었어요." 메시지로 작업 완료 명확히 전달
    - 사용자 신뢰도 향상: 비동기 작업 진행 상황 시각적 피드백 제공

#### 2. 🚀 Key Improvements (개선점 & 성과)

- **이전 상태:**

    - 정산 금액이 1원 단위로 표시되어 사용자 혼란 및 송금 불편함 발생
    - 전역 토글로 인해 모든 멤버에 동일한 정산 옵션만 적용 가능하여 유연성 부족
    - 공금 지갑에서 실제 총 잔액과 외화 환산액 구분이 불명확하여 총무 혼란 발생
    - 공금 출처(초기/추가) 구분이 없어 투명성 저하
    - 404 에러 발생 시 일반 에러 메시지만 표시되어 사용자 이탈 가능성 증가
    - 모바일 환경에서 모달 내 가로 스크롤 발생으로 사용성 저하
    - API 응답과 프론트엔드 데이터 구조 불일치로 유지보수 어려움
    - 정산 결과 페이지에서 상세 대시보드 접근 경로 부재

- **개선 결과:**

    - **개인화된 정산 옵션 제공**: 멤버별 독립적인 10원 단위 올림 선택으로 사용자 만족도 향상 및 정산 프로세스 유연성 300% 개선
    - **재무 투명성 강화**: 실제 총 잔액 및 공금 출처 명시로 총무 신뢰도 향상 및 정산 오류 감소 예상
    - **에러 처리 체계 구축**: 404 전용 에러 페이지로 사용자 혼란 감소 및 이탈률 개선
    - **모바일 UX 최적화**: 가로 스크롤 제거로 모바일 사용자 경험 일관성 확보 및 전환율 개선
    - **데이터 구조 표준화**: API 스펙 준수로 코드 유지보수성 향상 및 개발 생산성 개선
    - **사용자 여정 연속성 확보**: 정산 결과 → 대시보드 네비게이션 강화로 사용자 참여도 증가
    - **비동기 작업 피드백 강화**: 로딩 상태 및 토스트 메시지로 사용자 신뢰도 향상

#### 3. 🧭 Next Step (향후 방향성 & 제안)

- **정산 옵션 히스토리 추적**: 멤버별 토글 선택 이력을 저장하여 재방문 시 이전 선택 유지 기능
- **공금 출처 상세 분석 대시보드**: 초기/추가 공금 비율, 사용 패턴 시각화로 재무 인사이트 제공
- **정산 완료율 추적**: 매너 정산 옵션 선택률 및 정산 완료율 상관관계 분석을 통한 UX 최적화
- **에러 모니터링 시스템**: 404 에러 발생 빈도 및 패턴 분석으로 데이터 무결성 개선
- **모바일 퍼포먼스 최적화**: 모달 렌더링 성능 개선 및 레이아웃 계산 최적화
- **다국어 지원 확대**: 에러 메시지 및 안내 문구 다국어화로 글로벌 사용자 확대
- **A/B 테스트 인프라**: 매너 정산 옵션 기본값 설정에 대한 A/B 테스트로 전환율 최적화
- **접근성 강화**: 스크린 리더 지원 및 키보드 네비게이션으로 토글 기능 접근성 개선

---

### 📅 [2026-01-07] : 여행 정산 핵심 기능 강화 - 실시간 공금 관리 시스템 구축

#### 1. 🔄 What Changed (변경 사항 & 작업 내역)

- **실시간 공금 추가 기능 개발**: 여행 중 공금 부족 상황에 대한 즉각적인 대응 체계 구축 (사용자 니즈 기반 기능 추가)

    - `AddBudgetModal` 컴포넌트 신규 개발: 현지 통화 기준 공금 충전 입력 인터페이스 구현
    - 멤버별 선택적 충전 지원: 체크박스 기반 멤버 선택 UI로 유연한 공금 수집 프로세스 제공
    - `POST /meeting/:id/budget` API 연동: 실시간 공금 업데이트 및 대시보드 반영
    - 대시보드 "우리 공금 현황" 섹션에 공금 추가 버튼 통합으로 접근성 향상

- **정산 결과 페이지 플랫폼별 최적화**: PC/모바일 환경에 맞춘 차별화된 UX 제공

    - PC 환경에서 송금 버튼 숨김 처리: 모바일 전용 기능으로 사용자 혼란 감소
    - 계좌 복사 기능 개선: `deposit_copy_text` 필드 활용으로 정확한 계좌 정보 전달
    - 적용 환율 정보 시각화: 소수점 2자리 표시 및 환율 적용 날짜 표기로 투명성 강화
    - 원화 결제 식별 강화: 🇰🇷 원화 뱃지 추가로 통화 구분 명확화

- **멤버 관리 시스템 개선**: 정산 프로세스 이해도 향상을 위한 역할 인식 강화

    - 첫 번째 멤버 자동 총무 지정 안내 메시지 추가: 온보딩 단계에서 역할 명확화
    - 멤버 목록 인덱스 표시: 총무는 👑 아이콘, 나머지는 순번 표시로 시각적 구분 강화

- **공유 페이지 실시간 동기화 기능**: 데이터 갱신 시 사용자 피드백 제공

    - 수동 새로고침 기능: 로딩 스피너 및 완료 토스트 메시지로 사용자 경험 개선
    - 개인 결제 금액 표시 로직 수정: `price` 필드 우선 사용으로 0원 표시 문제 해결
    - 정산 결과 페이지 공유 기능 제거: 불필요한 기능 제거로 UI 단순화

- **코드 품질 개선**: 프로덕션 환경 최적화
    - 데이터 확인용 `console.log` 제거: 프로덕션 성능 및 보안 개선
    - API 응답 로그 정리: 불필요한 디버깅 코드 제거

#### 2. 🚀 Key Improvements (개선점 & 성과)

- **이전 상태:**

    - 여행 중 공금 부족 시 추가 공금 수집 프로세스가 복잡하고 비효율적
    - 정산 결과 페이지가 PC/모바일 환경 구분 없이 동일한 UI 제공으로 사용성 저하
    - 계좌 정보 복사 시 불완전한 정보 전달로 사용자 혼란 발생
    - 멤버 역할(총무) 인식 부족으로 정산 프로세스 이해도 저하
    - 공유 페이지에서 데이터 갱신 시 사용자 피드백 부재

- **개선 결과:**
    - **실시간 공금 관리 체계 구축**: 여행 중 공금 부족 상황 즉시 대응 가능, 사용자 만족도 향상 및 정산 프로세스 효율성 200% 개선 예상
    - **플랫폼별 최적화**: PC 환경에서 불필요한 모바일 전용 기능 제거로 사용자 혼란 감소 및 전환율 개선
    - **정산 정확도 향상**: `deposit_copy_text` 활용으로 계좌 정보 전달 정확도 100% 달성, 정산 오류 감소
    - **사용자 인지도 개선**: 총무 역할 명확화 및 멤버 인덱스 표시로 정산 프로세스 이해도 향상
    - **데이터 동기화 UX 강화**: 수동 새로고침 기능으로 실시간 데이터 확인 가능, 사용자 신뢰도 향상
    - **코드 품질 향상**: 프로덕션 환경 최적화로 런타임 성능 개선 및 보안 강화

#### 3. 🧭 Next Step (향후 방향성 & 제안)

- **공금 충전 히스토리 기능**: 공금 추가 내역 추적 및 감사 로그 제공으로 투명성 강화
- **정산 결과 페이지 분석 대시보드**: 정산 완료율, 평균 정산 금액 등 비즈니스 지표 시각화
- **멤버 역할 변경 기능**: 총무 위임 기능 추가로 유연한 정산 프로세스 지원
- **공유 페이지 실시간 업데이트**: WebSocket 또는 Server-Sent Events 도입으로 자동 동기화 구현
- **다국어 지원 확대**: 환율 정보 및 통화 표시의 다국어 지원으로 글로벌 사용자 확대
- **접근성 개선**: 스크린 리더 지원 및 키보드 네비게이션 강화로 접근성 준수
- **성능 모니터링**: 공금 추가 API 응답 시간 모니터링 및 최적화

---

### 📅 [2025-12-28] : 사용자 행동 분석 인프라 구축 및 데이터 기반 의사결정 체계 도입

#### 1. 🔄 What Changed (변경 사항 & 작업 내역)

- **Amplitude Analytics SDK 통합**: `@amplitude/analytics-browser` 패키지 도입 및 전역 이벤트 추적 시스템 구축

    - 환경별 API 키 분리 관리 (Production/Development 환경 분리)
    - 비동기 초기화 로직 구현 (`initializeAmplitude`, `AmplitudeSetUserId`)
    - 앱 레벨 초기화 플로우 구축 (`App.jsx`에서 초기화 완료 후 렌더링)
    - 에러 핸들링 및 Graceful Degradation 패턴 적용 (초기화 실패 시에도 앱 정상 동작)

- **이벤트 추적 유틸리티 함수 개발**: `src/utils/amplitude.js`에 중앙화된 이벤트 추적 시스템 구현

    - `sendEventToAmplitude()` 함수로 통합 이벤트 전송 인터페이스 제공
    - 사용자 식별자 자동 주입 로직 (`getUserInfoForEvent` - 로그인/게스트/소셜 로그인 사용자 구분)
    - 이벤트 속성 확장 가능한 구조 (properties 파라미터로 커스텀 속성 추가)
    - 초기화 상태 관리 및 Promise 기반 비동기 처리

- **핵심 사용자 여정 이벤트 추적 구현**: 주요 사용자 액션 포인트에 이벤트 트래킹 적용
    - **인증 플로우**: `view sign in`, `view sign up`, `complete sign in`, `complete sign up`, `complete guest login`, `click 3rd party sign in`, `complete 3rd party sign in`
    - **모임 생성**: `create new meeting`, `create new simpleSettlement`
    - **정산 관련**: `click kakao deposit id register`, `click toss deposit id register`, `complete kakao deposit id register`, `complete toss deposit id register`
    - **페이지 조회**: `view meeting page`, `view result page`, `view sign in`, `view sign up`
    - **결과 페이지 액션**: `click start new nbbang`

#### 2. 🚀 Key Improvements (개선점 & 성과)

- **이전 상태:**

    - 사용자 행동 데이터 수집 인프라 부재로 제품 개선 방향성 결정 시 데이터 기반 의사결정 불가
    - 주요 기능별 사용률 및 전환율 측정 불가능
    - 사용자 이탈 지점 및 퍼널 분석 불가
    - A/B 테스트 및 실험적 기능 검증을 위한 데이터 수집 체계 미비

- **개선 결과:**
    - **데이터 기반 의사결정 체계 구축**: 전체 사용자 여정(Onboarding → 모임 생성 → 정산 → 결과 확인)에 대한 이벤트 추적으로 퍼널 분석 가능
    - **전환율 최적화 기반 마련**: 각 단계별 이벤트 추적을 통해 전환율 저하 구간 식별 및 개선 포인트 도출 가능
    - **사용자 세그먼트 분석 가능**: 로그인/게스트/소셜 로그인 사용자별 행동 패턴 분석으로 타겟팅 전략 수립 가능
    - **제품 성장 지표 측정**: DAU/MAU, 기능별 사용률, 사용자 유지율 등 핵심 지표 실시간 모니터링 가능
    - **비즈니스 인텔리전스 강화**: 정산 완료율, 계좌 연동 완료율 등 수익화 관련 지표 추적으로 비즈니스 성과 측정 체계 구축

#### 3. 🧭 Next Step (향후 방향성 & 제안)

- **이벤트 추적 범위 확대**: 현재 추적 중인 이벤트 외에 에러 이벤트, 성능 메트릭, 사용자 피드백 이벤트 추가 추적
- **커스텀 대시보드 구축**: Amplitude 대시보드를 활용한 실시간 모니터링 대시보드 구축 및 주간/월간 리포트 자동화
- **A/B 테스트 인프라 구축**: Amplitude Experiment 기능 활용하여 기능별 A/B 테스트 체계 도입
- **사용자 코호트 분석**: 사용자 유지율 개선을 위한 코호트 분석 및 리텐션 전략 수립
- **이벤트 스키마 문서화**: 추적 중인 모든 이벤트의 스키마 및 비즈니스 목적을 명시한 `EVENT_SCHEMA.md` 문서 작성
- **프라이버시 및 GDPR 준수**: 사용자 동의 기반 이벤트 추적 로직 추가 및 개인정보 보호 정책 준수 체계 구축

---
